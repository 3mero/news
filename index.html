<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø´ØºÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„ØµÙˆØªÙŠØ§Øª ÙˆØ§Ù„ÙŠÙˆØªÙŠÙˆØ¨</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.plyr.io/3.6.8/plyr.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://cdn.plyr.io/3.6.8/plyr.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"></script>
  <script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      line-height: 1.6;
      font-size: 19px;
      color: #333;
      max-width: 100%;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .container {
      max-width: 1500px;
      margin: 0 auto;
      padding: 20px;
      background-color: #71706e;
    }

    h1, h2, h3, h4, h5, h6 {
      margin-top: 0;
      line-height: 1.2;
    }

    p {
      margin: 0 0 1em;
    }

    a {
      color: #007bff;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    button {
      font-family: inherit;
      font-size: inherit;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
      color: #fff;
    }

    img {
      max-width: 100%;
      height: auto;
    }

    .title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
    }

    .download-page {
      position: absolute;
      right: 20;
      top: 0;
    }

    .content-frame {
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 8px;
      background-color: #36454F;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .video-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
    }

    .plyr__video-embed {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    video, audio, iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .controls-bar {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .controls-bar button {
      margin: 0 5px;
    }

    .playlist-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #ccc;
    }

    .playlist-item:last-child {
      border-bottom: none;
    }

    .edit-icon, .delete-icon, .add-icon {
      cursor: pointer;
      margin-left: 10px;
    }

    .edit-icon:hover, .delete-icon:hover, .add-icon:hover {
      color: #007bff;
    }

    .dark-mode {
      background-color: #333;
      color: #fff;
    }

    .hidden-link {
      display: none;
    }

    .dropdown-toggle {
      color: #6c757d;
    }

    #total-links {
      color: red;
    }

    #search-container {
      position: absolute;
      top: -60px;
      right: 0;
      display: flex;
      align-items: center;
    }

    #search-container input {
      margin-right: 10px;
    }

    #clear-all {
      cursor: pointer;
      font-size: 20px;
      color: red;
    }

    #playlist {
      max-height: 400px;
      overflow-y: auto;
    }
    
    .channel-item {
  margin-bottom: 5px;
}

.channel-content {
  display: none;
  margin-left: 20px;
}

.channel-content .list-group-item {
  padding: 5px 15px;
}
    
    #footer-text {
  position: fixed;
  bottom: 0;
  width: 100%;
  background-color: #333;
  color: #fff;
  text-align: center;
  padding: 10px;
  font-size: 16px;
  transition: all 0.5s ease-in-out;
}

#footer-text:hover {
  opacity: 0;
  transform: translateY(20px);
}

  </style>
</head>
<body>
  <div class="container mt-4">
    <div class="title">
      Ù…Ø´ØºÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø·
      <button class="btn btn-secondary download-page" onclick="downloadPage()">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</button>
    </div>
    <div class="content-frame">
      <div id="search-container">
        <input type="text" id="searchInput" class="form-control" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©">
        <div id="clear-all">Ø­Ø°Ù Ø§Ù„ÙƒÙ„X</div>
      </div>
      <div class="lightbulb" onclick="toggleDarkMode()">ğŸŒ™/â˜€ï¸</div>
      <div class="row">
        <div class="col-12 col-md-8">
          <div class="video-container">
            <video id="video" controls></video>
            <audio id="audio" controls style="display: none;"></audio>
            <iframe id="youtube" style="display: none;" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
          </div>
          <div class="controls-bar mt-2">
            <button class="btn btn-primary" onclick="refreshPage()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</button>
            <button class="btn btn-primary" onclick="rewindVideo()">Ù„Ù„Ø®Ù„Ù 15 Ø«Ø§Ù†ÙŠØ©</button>
            <button class="btn btn-primary" onclick="toggleVideo()">ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù</button>
            <button class="btn btn-primary" onclick="forwardVideo()">ØªÙ‚Ø¯ÙŠÙ… 15 Ø«Ø§Ù†ÙŠØ©</button>
            <button class="btn btn-primary" onclick="setZoom(100)">ØªÙƒØ¨ÙŠØ±</button>
            <button class="btn btn-primary" onclick="setZoom(75)">ØªØµØºÙŠØ±</button>
          </div>
        </div>
        <div class="col-12 col-md-4 mt-4 mt-md-0">
          <div class="card mb-3">
            <div class="card-header bg-primary text-white">
              Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª
            </div>
            <div id="channelList" class="list-group list-group-flush">
              <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ù‡Ù†Ø§ -->
            </div>
          </div>
          <button class="btn btn-secondary mt-2" onclick="togglePlaylist()">Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©</button>
          <div id="fullPlaylist" style="display:none;">
            <div class="card mt-3">
              <div class="card-header bg-primary text-white">
                Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©
              </div>
              <div id="playlist" class="playlist list-group list-group-flush">
                <!-- Ø¹Ù†Ø§ØµØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø³ØªØ¨Ù‚Ù‰ Ù‡Ù†Ø§ -->
              </div>
            </div>
            <button class="btn btn-primary mt-2" onclick="addChannel()">Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø©</button>
            <button class="btn btn-success mt-2" onclick="savePlaylistToFile()">Ø­ÙØ¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</button>
            <input type="file" id="playlistFileInput" accept=".json,.m3u,.m3u8" onchange="loadPlaylistFromFile(event)" style="display: none;">
            <button class="btn btn-info mt-2" onclick="document.getElementById('playlistFileInput').click();">Ø¥Ø±ÙØ§Ù‚ Ù…Ù„Ù ØªØ´ØºÙŠÙ„ json + m3u/m3u8</button>
            <input type="text" id="playlistUrlInput" class="form-control mt-2" placeholder="json Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨ØµÙŠØºØ©">
            <button class="btn btn-warning mt-2" onclick="loadPlaylistFromUrl()">ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·</button>
            <div id="total-links" class="mt-2 text-center">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·: 0</div>
          </div>
        </div>
      </div>
    </div>
  </div>
<div id="footer-text">
  Editor by .. Omar K H
</div>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  
<script>
    var video = document.getElementById('video');
    var audio = document.getElementById('audio');
    var youtube = document.getElementById('youtube');
    var isPlaying = false;

    function refreshPage() {
      location.reload();
    }

    function rewindVideo() {
      if (video.style.display !== 'none') {
        video.currentTime -= 15;
      } else if (audio.style.display !== 'none') {
        audio.currentTime -= 15;
      } else {
        console.log("Cannot rewind YouTube videos");
      }
    }

    function forwardVideo() {
      if (video.style.display !== 'none') {
        video.currentTime += 15;
      } else if (audio.style.display !== 'none') {
        audio.currentTime += 15;
      } else {
        console.log("Cannot forward YouTube videos");
      }
    }

    function toggleVideo() {
      if (isPlaying) {
        if (video.style.display !== 'none') {
          video.pause();
        } else if (audio.style.display !== 'none') {
          audio.pause();
        } else {
          youtube.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
        }
      } else {
        if (video.style.display !== 'none') {
          video.play();
        } else if (audio.style.display !== 'none') {
          audio.play();
        } else {
          youtube.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
        }
      }
      isPlaying = !isPlaying;
    }

    function setZoom(zoom) {
      document.body.style.zoom = zoom + '%';
    }

    function playVideo(src) {
      var extension = src.split('.').pop().toLowerCase();
      console.log("Playing video with src: " + src + " and extension: " + extension);
      if (extension === 'm3u8') {
        if (Hls.isSupported()) {
          var hls = new Hls();
          hls.loadSource(src);
          hls.attachMedia(video);
          hls.on(Hls.Events.MANIFEST_PARSED, function () {
            video.style.display = 'block';
            audio.style.display = 'none';
            youtube.style.display = 'none';
            video.play();
            isPlaying = true;
          });
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = src;
          video.addEventListener('loadedmetadata', function () {
            video.style.display = 'block';
            audio.style.display = 'none';
            youtube.style.display = 'none';
            video.play();
            isPlaying = true;
          });
        }
      } else if (['mp4', 'webm', 'ogg'].includes(extension)) {
        video.src = src;
        video.addEventListener('loadedmetadata', function () {
          video.style.display = 'block';
          audio.style.display = 'none';
          youtube.style.display = 'none';
          video.play();
          isPlaying = true;
        });
      } else if (['mp3', 'wav', 'ogg'].includes(extension)) {
        audio.src = src;
        video.style.display = 'none';
        audio.style.display = 'block';
        youtube.style.display = 'none';
        audio.play();
        isPlaying = true;
      } else if (src.includes('youtube.com') || src.includes('youtu.be')) {
        var videoId = src.split('v=')[1] || src.split('/').pop();
        youtube.src = "https://www.youtube.com/embed/" + videoId + "?enablejsapi=1";
        video.style.display = 'none';
        audio.style.display = 'none';
        youtube.style.display = 'block';
      } else {
        console.error("Unsupported file extension: " + extension);
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }

    function deleteChannel(element) {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ù†Ø§Ø©ØŸ')) {
        var item = element.closest('.playlist-item');
        item.remove();
        savePlaylist();
        updateTotalLinks();
      }
    }

    function editLink(element) {
      var linkItem = element.closest('.list-group-item');
      var newLink = prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯:', linkItem.querySelector('.hidden-link').innerText);
      if (newLink) {
        linkItem.querySelector('.hidden-link').innerText = newLink;
        linkItem.setAttribute('onclick', `playVideo('${newLink}')`);
        savePlaylist();
      }
    }

    function editLinkName(element) {
      var linkItem = element.closest('.list-group-item');
      var newLinkName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯:', linkItem.querySelector('.link-name').innerText);
      if (newLinkName) {
        linkItem.querySelector('.link-name').innerText = newLinkName;
        savePlaylist();
      }
    }

    function editChannelName(element) {
      var item = element.closest('.playlist-item');
      var newName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯:', item.getAttribute('data-channel'));
      if (newName) {
        var channelLink = item.querySelector('.dropdown-toggle');
        channelLink.innerText = newName;
        item.setAttribute('data-channel', newName);
        var channelList = item.querySelector('.collapse');
        channelList.id = newName + '-list';
        channelLink.setAttribute('data-target', '#' + newName + '-list');
        savePlaylist();
      }
    }

    function addLink(element) {
      var item = element.closest('.playlist-item');
      var channelName = item.getAttribute('data-channel');
      var newLink = prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯:');
      var newLinkName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ùˆ Ø§Ù„Ø¬ÙˆØ¯Ø©:');
      if (newLink && newLinkName) {
        var newLinkItem = document.createElement('a');
        newLinkItem.href = '#';
        newLinkItem.classList.add('list-group-item', 'd-flex', 'justify-content-between', 'align-items-center');
        newLinkItem.innerHTML = `
          <span class="link-name">${newLinkName}</span>
          <span class="hidden-link">${newLink}</span>
          <div>
            <div class="edit-icon" onclick="editLinkName(this)">ğŸ–‹ï¸</div>
            <div class="edit-icon" onclick="editLink(this)">ğŸ–‹ï¸</div>
            <div class="delete-icon" onclick="deleteLink(this)">â</div>
          </div>
        `;
        newLinkItem.setAttribute('onclick', `playVideo('${newLink}')`);
        item.querySelector('.collapse').appendChild(newLinkItem);
        savePlaylist();
        updateTotalLinks();
      }
    }

    function deleteLink(element) {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ')) {
        var linkItem = element.closest('.list-group-item');
        linkItem.remove();
        savePlaylist();
        updateTotalLinks();
      }
    }

    function addChannel() {
      var newChannelName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:');
      if (newChannelName) {
        var newChannel = document.createElement('div');
        newChannel.classList.add('playlist-item');
        newChannel.setAttribute('data-channel', newChannelName);
        var newChannelId = 'channel-' + new Date().getTime();
        newChannel.innerHTML = `
          <div style="flex-grow: 1;">
            <a href="#" class="dropdown-toggle collapsed" data-toggle="collapse" data-target="#${newChannelId}-list" aria-expanded="false">
              ${newChannelName} (0 Ø±ÙˆØ§Ø¨Ø·)
            </a>
          </div>
          <div>
            <div class="edit-icon" onclick="editChannelName(this)">âœï¸</div>
            <div class="add-icon" onclick="addLink(this)">â•</div>
            <div class="delete-icon" onclick="deleteChannel(this)">âŒ</div>
          </div>
          <div class="collapse" id="${newChannelId}-list">
            <!-- Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§ -->
          </div>
        `;
        document.getElementById('playlist').appendChild(newChannel);
        savePlaylist();
      }
    }

    function savePlaylist() {
      var playlist = [];
      document.querySelectorAll('.playlist-item').forEach(function (item) {
        var channel = {
          name: item.getAttribute('data-channel'),
          links: []
        };
        item.querySelectorAll('.list-group-item').forEach(function (linkItem) {
          channel.links.push({
            name: linkItem.querySelector('.link-name').innerText,
            url: linkItem.querySelector('.hidden-link').innerText
          });
        });
        playlist.push(channel);
      });
      localStorage.setItem('playlist', JSON.stringify(playlist));
      updateTotalLinks();
      loadPlaylist(); // Refresh the channel list
    }

    function savePlaylistToFile() {
      var playlist = localStorage.getItem('playlist');
      var blob = new Blob([playlist], { type: 'application/json' });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      var fileName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„ØªØ´ØºÙŠÙ„:', 'playlist.json');
      if (fileName) {
        a.href = url;
        a.download = fileName;
        a.click();
        URL.revokeObjectURL(url);
      }
    }

    function loadPlaylistFromFile(event) {
      var file = event.target.files[0];
      var reader = new FileReader();
      reader.onload = function (e) {
        var content = e.target.result;
        if (file.name.endsWith('.json')) {
          localStorage.setItem('playlist', content);
          loadPlaylist();
        } else if (file.name.endsWith('.m3u') || file.name.endsWith('.m3u8')) {
          parseM3U(content);
        }
      };
      reader.readAsText(file);
    }

    function loadPlaylistFromUrl() {
      var url = document.getElementById('playlistUrlInput').value;
      fetch(url)
        .then(response => response.text())
        .then(data => {
          if (url.endsWith('.json')) {
            localStorage.setItem('playlist', data);
            loadPlaylist();
          } else if (url.endsWith('.m3u') || url.endsWith('.m3u8')) {
            parseM3U(data);
          }
        })
        .catch(error => console.error('Error loading playlist:', error));
    }

    function parseM3U(content) {
      var lines = content.split('\n');
      var playlist = [];
      var currentChannel = null;

      lines.forEach(line => {
        line = line.trim();
        if (line.startsWith('#EXTINF:')) {
          var channelInfo = line.split(',')[1];
          if (currentChannel && currentChannel.links.length > 0) {
            playlist.push(currentChannel);
          }
          currentChannel = {
            name: channelInfo,
            links: []
          };
        } else if (line && !line.startsWith('#') && currentChannel) {
          currentChannel.links.push({
            name: 'Link ' + (currentChannel.links.length + 1),
            url: line
          });
        }
      });

      if (currentChannel && currentChannel.links.length > 0) {
        playlist.push(currentChannel);
      }

      var existingPlaylist = JSON.parse(localStorage.getItem('playlist') || '[]');
      playlist = existingPlaylist.concat(playlist);
      localStorage.setItem('playlist', JSON.stringify(playlist));
      loadPlaylist();
    }

    function loadPlaylist() {
      var playlist = JSON.parse(localStorage.getItem('playlist') || '[]');
      var channelList = document.getElementById('channelList');
      var fullPlaylist = document.getElementById('playlist');
      
      channelList.innerHTML = '';
      fullPlaylist.innerHTML = '';
      
      playlist.forEach(function (channel, index) {
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª
        var channelItem = document.createElement('div');
        channelItem.classList.add('channel-item');
        
        var channelHeader = document.createElement('a');
        channelHeader.href = '#';
        channelHeader.classList.add('list-group-item', 'list-group-item-action');
        channelHeader.innerText = channel.name;
        channelHeader.onclick = function(e) { 
          e.preventDefault();
          toggleChannelExpand(this);
        };
        channelItem.appendChild(channelHeader);
        
        var channelContent = document.createElement('div');
        channelContent.classList.add('channel-content', 'collapse');
        
        channel.links.forEach(function(link, linkIndex) {
          var linkItem = document.createElement('a');
          linkItem.href = '#';
          linkItem.classList.add('list-group-item', 'list-group-item-action', 'pl-4');
          linkItem.innerText = link.name;
          linkItem.onclick = function() { playVideo(link.url); };
          channelContent.appendChild(linkItem);
        });
        
        channelItem.appendChild(channelContent);
        channelList.appendChild(channelItem);
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©
        var newChannel = document.createElement('div');
        newChannel.classList.add('playlist-item');
        newChannel.setAttribute('data-channel', channel.name);
        var newChannelId = 'channel-' + index;
        newChannel.innerHTML = `
          <div style="flex-grow: 1;">
            <a href="#" class="dropdown-toggle collapsed" data-toggle="collapse" data-target="#${newChannelId}-list" aria-expanded="false">
              ${channel.name} (${channel.links.length} Ø±ÙˆØ§Ø¨Ø·)
            </a>
          </div>
          <div>
            <div class="edit-icon" onclick="editChannelName(this)">âœï¸</div>
            <div class="add-icon" onclick="addLink(this)">â•</div>
            <div class="delete-icon" onclick="deleteChannel(this)">âŒ</div>
          </div>
          <div class="collapse" id="${newChannelId}-list">
${channel.links.map(link => `
              <a href="#" class="list-group-item d-flex justify-content-between align-items-center" onclick="playVideo('${link.url}')">
                <span class="link-name">${link.name}</span>
                <span class="hidden-link">${link.url}</span>
                <div>
                  <div class="edit-icon" onclick="editLinkName(this)">ğŸ–‹ï¸</div>
                  <div class="edit-icon" onclick="editLink(this)">ğŸ–‹ï¸</div>
                  <div class="delete-icon" onclick="deleteLink(this)">â</div>
                </div>
              </a>
            `).join('')}
          </div>
        `;
        fullPlaylist.appendChild(newChannel);
      });
      updateTotalLinks();
    }

    function toggleChannelExpand(element) {
      var content = element.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    }

    function playFirstLink(channelIndex) {
      var playlist = JSON.parse(localStorage.getItem('playlist') || '[]');
      if (playlist[channelIndex] && playlist[channelIndex].links.length > 0) {
        playVideo(playlist[channelIndex].links[0].url);
      }
    }

    function togglePlaylist() {
      var fullPlaylist = document.getElementById('fullPlaylist');
      if (fullPlaylist.style.display === 'none') {
        fullPlaylist.style.display = 'block';
      } else {
        fullPlaylist.style.display = 'none';
      }
    }

    function updateTotalLinks() {
      var totalLinks = 0;
      document.querySelectorAll('.playlist-item .list-group-item').forEach(function () {
        totalLinks++;
      });
      document.getElementById('total-links').innerText = 'Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·: ' + totalLinks;
    }

    function clearAllChannels() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§ØªØŸ')) {
        localStorage.removeItem('playlist');
        loadPlaylist();
      }
    }

  function filterChannels() {
    var input = document.getElementById('searchInput');
    var filter = input.value.toLowerCase();
    
    // Filter channels in the channel list
    var channelItems = document.querySelectorAll('#channelList .channel-item');
    channelItems.forEach(function(channel) {
      var channelName = channel.querySelector('.list-group-item').innerText.toLowerCase();
      var links = channel.querySelectorAll('.channel-content .list-group-item');
      var linkMatch = false;
      links.forEach(function(link) {
        var linkName = link.innerText.toLowerCase();
        if (linkName.indexOf(filter) > -1) {
          link.style.display = '';
          linkMatch = true;
        } else {
          link.style.display = 'none';
        }
      });
      if (channelName.indexOf(filter) > -1 || linkMatch) {
        channel.style.display = '';
      } else {
        channel.style.display = 'none';
      }
    });

    // Filter channels in the full playlist
    var playlistItems = document.querySelectorAll('#playlist .playlist-item');
    playlistItems.forEach(function(channel) {
      var channelName = channel.querySelector('.dropdown-toggle').innerText.toLowerCase();
      var links = channel.querySelectorAll('.list-group-item');
      var linkMatch = false;
      links.forEach(function(link) {
        var linkName = link.querySelector('.link-name').innerText.toLowerCase();
        if (linkName.indexOf(filter) > -1) {
          link.style.display = '';
          linkMatch = true;
        } else {
          link.style.display = 'none';
        }
      });
      if (channelName.indexOf(filter) > -1 || linkMatch) {
        channel.style.display = '';
      } else {
        channel.style.display = 'none';
      }
    });
  }


    function downloadPage() {
      var htmlContent = document.documentElement.outerHTML;
      var blob = new Blob([htmlContent], { type: 'text/html' });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      var fileName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:', 'page.html');
      if (fileName) {
        a.href = url;
        a.download = fileName;
        a.click();
        URL.revokeObjectURL(url);
      }
    }

  document.addEventListener('DOMContentLoaded', function () {
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
    }
    loadPlaylist();

    document.getElementById('searchInput').addEventListener('keyup', filterChannels);
    document.getElementById('clear-all').addEventListener('click', clearAllChannels);
  });
</script>
  
</body>
</html>
